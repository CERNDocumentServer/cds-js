<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>module.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="cdsRecordController.html">cdsRecordController</a><ul class='methods'><li data-type='method'><a href="cdsRecordController.html#.cdsRecordError">cdsRecordError</a></li><li data-type='method'><a href="cdsRecordController.html#.cdsRecordIframe">cdsRecordIframe</a></li><li data-type='method'><a href="cdsRecordController.html#.cdsRecordInit">cdsRecordInit</a></li><li data-type='method'><a href="cdsRecordController.html#.cdsRecordLoadingStart">cdsRecordLoadingStart</a></li><li data-type='method'><a href="cdsRecordController.html#.cdsRecordLoadingStop">cdsRecordLoadingStop</a></li><li data-type='method'><a href="cdsRecordController.html#.cdsRecordWarn">cdsRecordWarn</a></li></ul></li><li><a href="cdsRecordView.html">cdsRecordView</a><ul class='methods'><li data-type='method'><a href="cdsRecordView.html#.link">link</a></li><li data-type='method'><a href="cdsRecordView.html#.templateUrl">templateUrl</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">module.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 * This file is part of CERN Document Server.
 * Copyright (C) 2016 CERN.
 *
 * CERN Document Server is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License as
 * published by the Free Software Foundation; either version 2 of the
 * License, or (at your option) any later version.
 *
 * CERN Document Server is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with CERN Document Server; if not, write to the Free Software Foundation, Inc.,
 * 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
 *
 * In applying this license, CERN does not
 * waive the privileges and immunities granted to it by virtue of its status
 * as an Intergovernmental Organization or submit itself to any jurisdiction.
 */
(function (angular) {
  // Controllers

  /**
    * @ngdoc controller
    * @name cdsRecordController
    * @namespace cdsRecordController
    * @description
    *    CDS record controller.
    */
  function cdsRecordController($scope, $sce) {

    // Parameters

    // Assign the controller to `vm`
    var vm = this;

    // Record Loading - If the cdsRecord has the state loading
    vm.cdsRecordLoading = true;

    // Record Error - if the cdsRecord has any error
    vm.cdsRecordError = null;

    // Record Warn - if the cdsRecord has any warning
    vm.cdsRecordWarning = null;

    ////////////

    // Functions

    /**
      * Trust iframe url
      * @memberof cdsRecordController
      * @function cdsRecordIframe
      * @param {String} url - The url.
      */
    function cdsRecordIframe(url) {
      // Return the trusted url
      return $sce.trustAsResourceUrl(url);
    }

    /**
      * When the module initialized
      * @memberof cdsRecordController
      * @function cdsRecordInit
      * @param {Object} evt - The event object.
      */
    function cdsRecordInit(evt) {
      // Stop loading
      vm.cdsRecordLoading = false;
    }

    /**
      * Change the state to loading
      * @memberof cdsRecordController
      * @function cdsRecordLoadingStart
      * @param {Object} evt - The event object.
      */
    function cdsRecordLoadingStart(evt) {
      // Set the state to loading
      vm.cdsRecordLoading = true;
    }

    /**
      * Change the state to normal
      * @memberof cdsRecordController
      * @function cdsRecordLoadingStop
      * @param {Object} evt - The event object.
      */
    function cdsRecordLoadingStop(evt) {
      // Set the state to normal
      vm.cdsRecordLoading = false;
    }

    /**
      * Show error messages
      * @memberof cdsRecordController
      * @function cdsRecordError
      * @param {Object} evt - The event object.
      * @param {Object} error - The object with the errors.
      */
    function cdsRecordError(evt, error) {
      // Reset the error
      vm.cdsRecordError = null;
      // Attach the error to the scope
      vm.cdsRecordError = error;
    }

    /**
      * Show warning messages
      * @memberof cdsRecordController
      * @function cdsRecordWarn
      * @param {Object} evt - The event object.
      * @param {Object} warning - The object with the warnings.
      */
    function cdsRecordWarn(evt, warning) {
      // Reset the error
      vm.cdsRecordWarning = null;
      // Attach the warning to the scope
      vm.cdsRecordWarning = warning;
    }

    ////////////

    // Assignements

    // Iframe src
    vm.iframeSrc = cdsRecordIframe;

    ////////////

    // Listeners

    // When the module initialized
    $scope.$on('cds.record.init', cdsRecordInit);

    // When there is an error
    $scope.$on('cds.record.error', cdsRecordError);
    // When there is a warning
    $scope.$on('cds.record.warn', cdsRecordWarn);

    // When loading requested to start
    $scope.$on('cds.record.loading.start', cdsRecordLoadingStart);
    // When loading requested to stop
    $scope.$on('cds.record.loading.stop', cdsRecordLoadingStop);
  }

  cdsRecordController.$inject = ['$scope', '$sce'];

  ////////////

  // Directives

  /**
    * @ngdoc directive
    * @name cdsRecordView
    * @description
    *    The cdsRecordView directive
    * @namespace cdsRecordView
    * @example
    *    Usage:
    *    &lt;cds-record-view
    *     template='TEMPLATE_PATH'>
    *    &lt;/cds-record-view>
    */
  function cdsRecordView($http) {

    // Functions

    /**
      * Force apply the attributes to the scope
      * @memberof cdsRecordView
      * @param {service} scope -  The scope of this element.
      * @param {service} element - Element that this direcive is assigned to.
      * @param {service} attrs - Attribute of this element.
      * @param {cdsRecordCtrl} vm - CERN Document Server record controller.
      */
    function link(scope, element, attrs, vm) {
      try {
        // Get the record object and make it available to the scope
        scope.record = JSON.parse(attrs.record);
        // Broadcast the love
        scope.$broadcast('cds.record.init');
      } catch(error) {
        if ((attrs.record || '').charAt(0) === '/') {
          $http.get(attrs.record)
            .then(function(response) {
              scope.record = response.data;
              // Broadcast
              scope.$broadcast('cds.record.init');
            }, function(error) {
              // Throw the error
              scope.$broadcast('cds.record.error', error);
            });
        } else {
          scope.$broadcast('cds.record.error', error);
        }
      }
    }

    /**
      * Choose template for search bar
      * @memberof cdsRecordView
      * @param {service} element - Element that this direcive is assigned to.
      * @param {service} attrs - Attribute of this element.
      * @example
      *    Minimal template `template.html` usage
      *    {{ record.title_statement.title }}
      */
    function templateUrl(element, attrs) {
      return attrs.template;
    }

    ////////////

    return {
      restrict: 'AE',
      scope: false,
      controller: 'cdsRecordCtrl',
      controllerAs: 'vm',
      link: link,
      templateUrl: templateUrl,
    };
  }

  cdsRecordView.$inject = ['$http'];

  ////////////

  // Setup everything

  angular.module('cdsRecord.directives', [])
    .directive('cdsRecordView', cdsRecordView);

  angular.module('cdsRecord.controllers', [])
    .controller('cdsRecordCtrl', cdsRecordController);

  angular.module('cdsRecord', [
    'cdsRecord.controllers',
    'cdsRecord.directives'
  ]);

  //////////// HAPPY CDS Devs :)

})(angular);
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Tue Apr 04 2017 15:35:50 GMT+0000 (UTC) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
